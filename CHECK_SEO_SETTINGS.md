# Cách kiểm tra SEO Settings trong PostgreSQL

## Cách 1: Sử dụng psql (khuyến nghị)

```bash
# Kết nối đến PostgreSQL (thay thế thông tin nếu cần)
psql -U your_username -d your_database_name

# Hoặc nếu có .env file
cd /var/www/Spa/CMS/backend
source .env 2>/dev/null || true
psql $DATABASE_URL

# Sau khi vào psql, chạy:
SELECT value FROM settings WHERE namespace = 'seo';

# Xem dạng JSON đẹp hơn:
SELECT jsonb_pretty(value) FROM settings WHERE namespace = 'seo';

# Đếm số pages:
SELECT jsonb_array_length(value->'pages') as total_pages FROM settings WHERE namespace = 'seo';

# Xem danh sách paths:
SELECT jsonb_array_elements(value->'pages')->>'path' as path FROM settings WHERE namespace = 'seo';
```

## Cách 2: Sử dụng Node.js script

Tạo file `check-seo.js`:

```javascript
const { Client } = require('pg');
require('dotenv').config();

const client = new Client({
  connectionString: process.env.DATABASE_URL
});

async function checkSEO() {
  await client.connect();
  const result = await client.query('SELECT value FROM settings WHERE namespace = $1', ['seo']);
  const seo = result.rows[0]?.value || { pages: [] };
  
  console.log('Total pages:', seo.pages?.length || 0);
  console.log('\nStatic pages (non-products):');
  seo.pages?.filter(p => !(p.autoGenerated === true && p.path?.startsWith('/products/'))).forEach(p => {
    console.log(`  - ${p.path} (${p.autoGenerated ? 'auto' : 'custom'})`);
  });
  console.log('\nProduct pages:');
  seo.pages?.filter(p => p.autoGenerated === true && p.path?.startsWith('/products/')).forEach(p => {
    console.log(`  - ${p.path}`);
  });
  
  await client.end();
}

checkSEO().catch(console.error);
```

Chạy:
```bash
cd /var/www/Spa/CMS/backend
node check-seo.js
```

## Cách 3: Qua API (nếu có endpoint)

```bash
curl -X GET https://api.banyco.vn/api/settings/seo
```

## Kiểm tra trước và sau khi duplicate product

1. **Trước khi duplicate:**
   ```bash
   # Ghi lại số lượng static pages
   psql ... -c "SELECT jsonb_array_length(value->'pages') FROM settings WHERE namespace = 'seo';"
   ```

2. **Duplicate product**

3. **Sau khi duplicate:**
   ```bash
   # Kiểm tra lại - số lượng phải giữ nguyên
   psql ... -c "SELECT jsonb_array_length(value->'pages') FROM settings WHERE namespace = 'seo';"
   ```
